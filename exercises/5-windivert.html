<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>5-windivert - Reverse Engineering Exercises</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Reverse Engineering Exercises</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Jozefpodlecki/reverse-engineering-exercises" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>This exercise explores how</p>
<p><a href="https://github.com/Jozefpodlecki/reverse-engineering-exercises/blob/main/exercises/windivert/src/main.rs">source</a></p>
<h3 id="function-prologue"><a class="header" href="#function-prologue">Function Prologue</a></h3>
<pre><code class="language-x86asm">00007FF7C3EE8C70 | 55           | push rbp
...
00007FF7C3EE8C7C | 48:81EC B8020000 | sub rsp,2B8
</code></pre>
<p>Allocate 696 bytes on stack for</p>
<ul>
<li>Local variables (like buffer, windivert, tx, etc.)</li>
<li>Rust runtime bookkeeping (Vec metadata, thread closure captures)</li>
</ul>
<h3 id="zeroing--initializing-memory"><a class="header" href="#zeroing--initializing-memory">Zeroing / Initializing memory</a></h3>
<pre><code>00007FF7C3EE8CC1 | 0F57C0        | xorps xmm0,xmm0
00007FF7C3EE8CC4 | 0F2983 80000000 | movaps xmmword ptr ds:[rbx+80],xmm0
00007FF7C3EE8CCB | 0F2983 00010000 | movaps xmmword ptr ds:[rbx+100],xmm0
00007FF7C3EE8CD2 | 66:C783 80010000 0000 | mov word ptr ds:[rbx+180],0
00007FF7C3EE8CDB | 48:C783 88010000 00000000 | mov qword ptr ds:[rbx+188],0
</code></pre>
<h3 id="stack-alignment--frame-pointers"><a class="header" href="#stack-alignment--frame-pointers">Stack alignment &amp; frame pointers</a></h3>
<pre><code>00007FF7C3EE8C83 | 48:8DAC24 80000000 | lea rbp,qword ptr ss:[rsp+80]
00007FF7C3EE8C8B | 48:83E4 80        | and rsp,FFFFFFFFFFFFFF80
00007FF7C3EE8C8F | 48:89E3           | mov rbx,rsp
</code></pre>
<h3 id="memory-allocation"><a class="header" href="#memory-allocation">Memory allocation</a></h3>
<pre><code class="language-x86asm">00007FF7C3EE8D15 | 0FB605 25D40200 | movzx eax,byte ptr ds:[&lt;__rust_no_alloc_shim_is_unstable&gt;]
00007FF7C3EE8D1C | B9 00020000      | mov ecx,200
00007FF7C3EE8D21 | BA 80000000      | mov edx,80
00007FF7C3EE8D26 | E8 A5260000      | call &lt;windivert.__rustc::__rust_alloc&gt;
00007FF7C3EE8D2B | 48:85C0         | test rax,rax
</code></pre>
<p>Rust runtime is calling __rust_alloc to allocate heap memory:</p>
<p>rcx, rdx = allocation size and alignment.</p>
<p>rax = pointer to allocated memory.</p>
<p>test rax, rax checks if allocation failed (None if null).</p>
<h3 id="copying-strings--data"><a class="header" href="#copying-strings--data">Copying strings / data</a></h3>
<pre><code class="language-x86asm">00007FF7C3EE8D37 | 48:8D93 80000000 | lea rdx,qword ptr ds:[rbx+80]
00007FF7C3EE8D44 | 48:89C1         | mov rcx,rax
00007FF7C3EE8D47 | E8 10BE0100     | call &lt;windivert.memcpy&gt;
</code></pre>
<h3 id="channel-setup-and-threads"><a class="header" href="#channel-setup-and-threads">Channel setup and threads</a></h3>
<pre><code class="language-x86asm">00007FF7C3EE8D99 | 4C:8D43 68 | lea r8,qword ptr ds:[rbx+68]
00007FF7C3EE8D9D | E8 CE130000 | call &lt;windivert.std::thread::Builder::spawn_unchecked&gt;
</code></pre>
<p>This is spawning a thread in Rust.</p>
<p>Arguments: stack pointers, local buffer, and channel sender (tx) are passed as thread closure environment.</p>
<p>Rust runtime handles closure captures in memory and passes a pointer to spawn_unchecked.</p>
<pre><code>00007FF7C3EE83E0 | 55                               | push rbp                                                                                     |
00007FF7C3EE83E1 | 41:57                            | push r15                                                                                     |
00007FF7C3EE83E3 | 41:56                            | push r14                                                                                     |
00007FF7C3EE83E5 | 41:55                            | push r13                                                                                     |
00007FF7C3EE83E7 | 41:54                            | push r12                                                                                     |
00007FF7C3EE83E9 | 56                               | push rsi                                                                                     |
00007FF7C3EE83EA | 57                               | push rdi                                                                                     |
00007FF7C3EE83EB | 53                               | push rbx                                                                                     |
00007FF7C3EE83EC | 48:81EC 28010000                 | sub rsp,128                                                                                  |
00007FF7C3EE83F3 | 48:8DAC24 80000000               | lea rbp,qword ptr ss:[rsp+80]                                                                |
00007FF7C3EE83FB | 48:C785 A0000000 FEFFFFFF        | mov qword ptr ss:[rbp+A0],FFFFFFFFFFFFFFFE                                                   |
00007FF7C3EE8406 | 48:894D 68                       | mov qword ptr ss:[rbp+68],rcx                                                                |
00007FF7C3EE840A | 48:8D41 10                       | lea rax,qword ptr ds:[rcx+10]                                                                | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE840E | 48:8945 40                       | mov qword ptr ss:[rbp+40],rax                                                                |
00007FF7C3EE8412 | 48:8D05 77B60100                 | lea rax,qword ptr ds:[&lt;core::fmt::num::imp::_$LT$impl$u20$core..fmt..Display$u20$for$u20$i32 | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE8419 | 48:8945 48                       | mov qword ptr ss:[rbp+48],rax                                                                | [rbp+48]:core::fmt::num::imp::_$LT$impl$u20$core..fmt..Display$u20$for$u20$i32$GT$::fmt::h2816672a2b9a7a5a
00007FF7C3EE841D | 48:8D05 84FD0100                 | lea rax,qword ptr ds:[7FF7C3F081A8]                                                          | rax:&amp;"tcp.SrcPort == ", 00007FF7C3F081A8:&amp;"tcp.SrcPort == "
00007FF7C3EE8424 | 48:8945 C0                       | mov qword ptr ss:[rbp-40],rax                                                                | [rbp-40]:&amp;"tcp.SrcPort == "
00007FF7C3EE8428 | 48:C745 C8 01000000              | mov qword ptr ss:[rbp-38],1                                                                  |
00007FF7C3EE8430 | 48:C745 E0 00000000              | mov qword ptr ss:[rbp-20],0                                                                  |
00007FF7C3EE8438 | 48:8D45 40                       | lea rax,qword ptr ss:[rbp+40]                                                                |
00007FF7C3EE843C | 48:8945 D0                       | mov qword ptr ss:[rbp-30],rax                                                                |
00007FF7C3EE8440 | 48:C745 D8 01000000              | mov qword ptr ss:[rbp-28],1                                                                  |
00007FF7C3EE8448 | 48:8D8D 80000000                 | lea rcx,qword ptr ss:[rbp+80]                                                                |
00007FF7C3EE844F | 48:8D55 C0                       | lea rdx,qword ptr ss:[rbp-40]                                                                | [rbp-40]:&amp;"tcp.SrcPort == "
00007FF7C3EE8453 | E8 886F0100                      | call &lt;windivert.alloc::fmt::format::format_inner::hfc6b6ff323357fe5&gt;                         |
00007FF7C3EE8458 | 0F1085 80000000                  | movups xmm0,xmmword ptr ss:[rbp+80]                                                          |
00007FF7C3EE845F | 0F2945 40                        | movaps xmmword ptr ss:[rbp+40],xmm0                                                          |
00007FF7C3EE8463 | 48:8B85 90000000                 | mov rax,qword ptr ss:[rbp+90]                                                                |
00007FF7C3EE846A | 48:8945 50                       | mov qword ptr ss:[rbp+50],rax                                                                |
00007FF7C3EE846E | 48:8D8D 80000000                 | lea rcx,qword ptr ss:[rbp+80]                                                                |
00007FF7C3EE8475 | 48:8D55 40                       | lea rdx,qword ptr ss:[rbp+40]                                                                |
00007FF7C3EE8479 | 41:B9 05000000                   | mov r9d,5                                                                                    |
00007FF7C3EE847F | 45:31C0                          | xor r8d,r8d                                                                                  |
00007FF7C3EE8482 | E8 391B0000                      | call &lt;windivert.windivert::divert::WinDivert$LT$windivert..layer..NetworkLayer$GT$::network: |
00007FF7C3EE8487 | 48:B8 0700000000000080           | mov rax,8000000000000007                                                                     | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE8491 | 48:3985 80000000                 | cmp qword ptr ss:[rbp+80],rax                                                                |
00007FF7C3EE8498 | 0F85 A5020000                    | jne windivert.7FF7C3EE8743                                                                   |
00007FF7C3EE849E | 48:8B85 88000000                 | mov rax,qword ptr ss:[rbp+88]                                                                |
00007FF7C3EE84A5 | 8B8D 90000000                    | mov ecx,dword ptr ss:[rbp+90]                                                                |
00007FF7C3EE84AB | 48:8945 B0                       | mov qword ptr ss:[rbp-50],rax                                                                |
00007FF7C3EE84AF | 894D B8                          | mov dword ptr ss:[rbp-48],ecx                                                                |
00007FF7C3EE84B2 | 0FB605 88DC0200                  | movzx eax,byte ptr ds:[&lt;__rust_no_alloc_shim_is_unstable&gt;]                                   |
00007FF7C3EE84B9 | B9 FFFF0000                      | mov ecx,FFFF                                                                                 |
00007FF7C3EE84BE | BA 01000000                      | mov edx,1                                                                                    |
00007FF7C3EE84C3 | E8 382F0000                      | call &lt;windivert.__rustc::__rust_alloc_zeroed&gt;                                                |
00007FF7C3EE84C8 | 48:8945 70                       | mov qword ptr ss:[rbp+70],rax                                                                |
00007FF7C3EE84CC | 48:85C0                          | test rax,rax                                                                                 | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE84CF | 75 1B                            | jne windivert.7FF7C3EE84EC                                                                   |
00007FF7C3EE84D1 | 4C:8D05 08FD0100                 | lea r8,qword ptr ds:[7FF7C3F081E0]                                                           | 00007FF7C3F081E0:&amp;"src\\main.rs"
00007FF7C3EE84D8 | B9 01000000                      | mov ecx,1                                                                                    |
00007FF7C3EE84DD | BA FFFF0000                      | mov edx,FFFF                                                                                 |
00007FF7C3EE84E2 | E8 6CDB0100                      | call &lt;windivert.alloc::raw_vec::handle_error::h5d55154af761dff4&gt;                             |
00007FF7C3EE84E7 | E9 B1020000                      | jmp windivert.7FF7C3EE879D                                                                   |
00007FF7C3EE84EC | 48:8D75 C0                       | lea rsi,qword ptr ss:[rbp-40]                                                                | [rbp-40]:&amp;"tcp.SrcPort == "
00007FF7C3EE84F0 | 48:8D7D B0                       | lea rdi,qword ptr ss:[rbp-50]                                                                |
00007FF7C3EE84F4 | 49:BD 0100000000000080           | mov r13,8000000000000001                                                                     |
00007FF7C3EE84FE | 48:8D9D 80000000                 | lea rbx,qword ptr ss:[rbp+80]                                                                |
00007FF7C3EE8505 | 41:BC 01000000                   | mov r12d,1                                                                                   |
00007FF7C3EE850B | EB 14                            | jmp windivert.7FF7C3EE8521                                                                   |
00007FF7C3EE850D | 0F1F00                           | nop dword ptr ds:[rax],eax                                                                   |
00007FF7C3EE8510 | 48:8D0455 00000000               | lea rax,qword ptr ds:[rdx*2]                                                                 | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE8518 | 48:85C0                          | test rax,rax                                                                                 | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE851B | 0F85 5F010000                    | jne windivert.7FF7C3EE8680                                                                   |
00007FF7C3EE8521 | 41:B9 FFFF0000                   | mov r9d,FFFF                                                                                 |
00007FF7C3EE8527 | 48:89F1                          | mov rcx,rsi                                                                                  |
00007FF7C3EE852A | 48:89FA                          | mov rdx,rdi                                                                                  |
00007FF7C3EE852D | 4C:8B45 70                       | mov r8,qword ptr ss:[rbp+70]                                                                 |
00007FF7C3EE8531 | E8 EA2E0000                      | call &lt;windivert.windivert::divert::blocking::_$LT$impl$u20$windivert..divert..WinDivert$LT$w |
00007FF7C3EE8536 | 48:8B45 C0                       | mov rax,qword ptr ss:[rbp-40]                                                                | [rbp-40]:&amp;"tcp.SrcPort == "
00007FF7C3EE853A | 4C:39E8                          | cmp rax,r13                                                                                  | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE853D | 0F84 51010000                    | je windivert.7FF7C3EE8694                                                                    |
00007FF7C3EE8543 | 48:8945 60                       | mov qword ptr ss:[rbp+60],rax                                                                |
00007FF7C3EE8547 | 48:8B45 C8                       | mov rax,qword ptr ss:[rbp-38]                                                                |
00007FF7C3EE854B | 48:8945 78                       | mov qword ptr ss:[rbp+78],rax                                                                |
00007FF7C3EE854F | 4C:8B7D D0                       | mov r15,qword ptr ss:[rbp-30]                                                                |
00007FF7C3EE8553 | 4D:85FF                          | test r15,r15                                                                                 |
00007FF7C3EE8556 | 0F88 27020000                    | js windivert.7FF7C3EE8783                                                                    |
00007FF7C3EE855C | 74 22                            | je windivert.7FF7C3EE8580                                                                    |
00007FF7C3EE855E | 0FB605 DCDB0200                  | movzx eax,byte ptr ds:[&lt;__rust_no_alloc_shim_is_unstable&gt;]                                   |
00007FF7C3EE8565 | BA 01000000                      | mov edx,1                                                                                    |
00007FF7C3EE856A | 4C:89F9                          | mov rcx,r15                                                                                  |
00007FF7C3EE856D | E8 5E2E0000                      | call &lt;windivert.__rustc::__rust_alloc&gt;                                                       |
00007FF7C3EE8572 | 48:85C0                          | test rax,rax                                                                                 | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE8575 | 0F84 0D020000                    | je windivert.7FF7C3EE8788                                                                    |
00007FF7C3EE857B | 49:89C6                          | mov r14,rax                                                                                  | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE857E | EB 06                            | jmp windivert.7FF7C3EE8586                                                                   |
00007FF7C3EE8580 | 41:BE 01000000                   | mov r14d,1                                                                                   |
00007FF7C3EE8586 | 4C:89F1                          | mov rcx,r14                                                                                  |
00007FF7C3EE8589 | 48:8B55 78                       | mov rdx,qword ptr ss:[rbp+78]                                                                |
00007FF7C3EE858D | 4D:89F8                          | mov r8,r15                                                                                   |
00007FF7C3EE8590 | E8 C7C50100                      | call &lt;windivert.memcpy&gt;                                                                      |
00007FF7C3EE8595 | 48:8B4D 68                       | mov rcx,qword ptr ss:[rbp+68]                                                                |
00007FF7C3EE8599 | 48:8B01                          | mov rax,qword ptr ds:[rcx]                                                                   | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE859C | 48:8B51 08                       | mov rdx,qword ptr ds:[rcx+8]                                                                 |
00007FF7C3EE85A0 | 48:83F8 02                       | cmp rax,2                                                                                    | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE85A4 | 74 3A                            | je windivert.7FF7C3EE85E0                                                                    |
00007FF7C3EE85A6 | 83F8 01                          | cmp eax,1                                                                                    |
00007FF7C3EE85A9 | 75 65                            | jne windivert.7FF7C3EE8610                                                                   |
00007FF7C3EE85AB | 4C:89BD 80000000                 | mov qword ptr ss:[rbp+80],r15                                                                |
00007FF7C3EE85B2 | 4C:89B5 88000000                 | mov qword ptr ss:[rbp+88],r14                                                                |
00007FF7C3EE85B9 | 4C:89BD 90000000                 | mov qword ptr ss:[rbp+90],r15                                                                |
00007FF7C3EE85C0 | C74424 20 00CA9A3B               | mov dword ptr ss:[rsp+20],3B9ACA00                                                           |
00007FF7C3EE85C8 | 48:89F1                          | mov rcx,rsi                                                                                  |
00007FF7C3EE85CB | 49:89D8                          | mov r8,rbx                                                                                   |
00007FF7C3EE85CE | E8 2D9DFFFF                      | call &lt;windivert.std::sync::mpmc::list::Channel$LT$T$GT$::send::hccb9013442662364&gt;            |
00007FF7C3EE85D3 | EB 63                            | jmp windivert.7FF7C3EE8638                                                                   |
00007FF7C3EE85D5 | 66662E:0F1F8400 00000000         | nop word ptr ds:[rax+rax],ax                                                                 |
00007FF7C3EE85E0 | 4C:89BD 80000000                 | mov qword ptr ss:[rbp+80],r15                                                                |
00007FF7C3EE85E7 | 4C:89B5 88000000                 | mov qword ptr ss:[rbp+88],r14                                                                |
00007FF7C3EE85EE | 4C:89BD 90000000                 | mov qword ptr ss:[rbp+90],r15                                                                |
00007FF7C3EE85F5 | C74424 20 00CA9A3B               | mov dword ptr ss:[rsp+20],3B9ACA00                                                           |
00007FF7C3EE85FD | 48:89F1                          | mov rcx,rsi                                                                                  |
00007FF7C3EE8600 | 49:89D8                          | mov r8,rbx                                                                                   |
00007FF7C3EE8603 | E8 28D3FFFF                      | call &lt;windivert.std::sync::mpmc::zero::Channel$LT$T$GT$::send::h6f8bab36c27d44da&gt;            |
00007FF7C3EE8608 | EB 2E                            | jmp windivert.7FF7C3EE8638                                                                   |
00007FF7C3EE860A | 66:0F1F4400 00                   | nop word ptr ds:[rax+rax],ax                                                                 |
00007FF7C3EE8610 | 4C:89BD 80000000                 | mov qword ptr ss:[rbp+80],r15                                                                |
00007FF7C3EE8617 | 4C:89B5 88000000                 | mov qword ptr ss:[rbp+88],r14                                                                |
00007FF7C3EE861E | 4C:89BD 90000000                 | mov qword ptr ss:[rbp+90],r15                                                                |
00007FF7C3EE8625 | C74424 20 00CA9A3B               | mov dword ptr ss:[rsp+20],3B9ACA00                                                           |
00007FF7C3EE862D | 48:89F1                          | mov rcx,rsi                                                                                  |
00007FF7C3EE8630 | 49:89D8                          | mov r8,rbx                                                                                   |
00007FF7C3EE8633 | E8 C8ADFFFF                      | call &lt;windivert.std::sync::mpmc::array::Channel$LT$T$GT$::send::h3f0d389a1efe5b98&gt;           |
00007FF7C3EE8638 | 48:8B45 C0                       | mov rax,qword ptr ss:[rbp-40]                                                                | [rbp-40]:&amp;"tcp.SrcPort == "
00007FF7C3EE863C | 48:83F8 02                       | cmp rax,2                                                                                    | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE8640 | 48:8B55 60                       | mov rdx,qword ptr ss:[rbp+60]                                                                |
00007FF7C3EE8644 | 0F84 C6FEFFFF                    | je windivert.7FF7C3EE8510                                                                    |
00007FF7C3EE864A | 48:8B4D C8                       | mov rcx,qword ptr ss:[rbp-38]                                                                |
00007FF7C3EE864E | A8 01                            | test al,1                                                                                    |
00007FF7C3EE8650 | 0F84 C3000000                    | je windivert.7FF7C3EE8719                                                                    |
00007FF7C3EE8656 | 48:8D45 C8                       | lea rax,qword ptr ss:[rbp-38]                                                                |
00007FF7C3EE865A | 0F1040 08                        | movups xmm0,xmmword ptr ds:[rax+8]                                                           | rax+08:anon.95dd94260625f633aaffbc1dd64e9bca.29.llvm.18142701166963205077+3F8
00007FF7C3EE865E | 0F2985 80000000                  | movaps xmmword ptr ss:[rbp+80],xmm0                                                          |
00007FF7C3EE8665 | 48:89C8                          | mov rax,rcx                                                                                  | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE8668 | 48:F7D8                          | neg rax                                                                                      | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE866B | 0F80 9FFEFFFF                    | jo windivert.7FF7C3EE8510                                                                    |
00007FF7C3EE8671 | EB 6A                            | jmp windivert.7FF7C3EE86DD                                                                   |
00007FF7C3EE8673 | 666666662E:0F1F8400 00000000     | nop word ptr ds:[rax+rax],ax                                                                 |
00007FF7C3EE8680 | 41:B8 01000000                   | mov r8d,1                                                                                    |
00007FF7C3EE8686 | 48:8B4D 78                       | mov rcx,qword ptr ss:[rbp+78]                                                                |
00007FF7C3EE868A | E8 512D0000                      | call &lt;windivert.__rustc::__rust_dealloc&gt;                                                     |
00007FF7C3EE868F | E9 8DFEFFFF                      | jmp windivert.7FF7C3EE8521                                                                   |
00007FF7C3EE8694 | 48:8D45 C8                       | lea rax,qword ptr ss:[rbp-38]                                                                |
00007FF7C3EE8698 | 0F1000                           | movups xmm0,xmmword ptr ds:[rax]                                                             | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE869B | 0F1048 10                        | movups xmm1,xmmword ptr ds:[rax+10]                                                          | rax+10:"src\\main.rs"
00007FF7C3EE869F | 0F298D 90000000                  | movaps xmmword ptr ss:[rbp+90],xmm1                                                          |
00007FF7C3EE86A6 | 0F2985 80000000                  | movaps xmmword ptr ss:[rbp+80],xmm0                                                          |
00007FF7C3EE86AD | 48:8D05 44FB0100                 | lea rax,qword ptr ds:[7FF7C3F081F8]                                                          | rax:&amp;"tcp.SrcPort == ", 00007FF7C3F081F8:&amp;"src\\main.rs"
00007FF7C3EE86B4 | 48:894424 20                     | mov qword ptr ss:[rsp+20],rax                                                                |
00007FF7C3EE86B9 | 48:8D0D 90F70100                 | lea rcx,qword ptr ds:[7FF7C3F07E50]                                                          | 00007FF7C3F07E50:"called `Result::unwrap()` on an `Err` value"
00007FF7C3EE86C0 | 4C:8D0D 69F70100                 | lea r9,qword ptr ds:[7FF7C3F07E30]                                                           |
00007FF7C3EE86C7 | 4C:8D85 80000000                 | lea r8,qword ptr ss:[rbp+80]                                                                 |
00007FF7C3EE86CE | BA 2B000000                      | mov edx,2B                                                                                   | 2B:'+'
00007FF7C3EE86D3 | E8 28DE0100                      | call &lt;windivert.core::result::unwrap_failed::h70751bb42e9051bd&gt;                              |
00007FF7C3EE86D8 | E9 C0000000                      | jmp windivert.7FF7C3EE879D                                                                   |
00007FF7C3EE86DD | 48:894D C0                       | mov qword ptr ss:[rbp-40],rcx                                                                | [rbp-40]:&amp;"tcp.SrcPort == "
00007FF7C3EE86E1 | 0F2885 80000000                  | movaps xmm0,xmmword ptr ss:[rbp+80]                                                          |
00007FF7C3EE86E8 | 0F1145 C8                        | movups xmmword ptr ss:[rbp-38],xmm0                                                          |
00007FF7C3EE86EC | 48:8D05 1DFB0100                 | lea rax,qword ptr ds:[7FF7C3F08210]                                                          | rax:&amp;"tcp.SrcPort == ", 00007FF7C3F08210:&amp;"src\\main.rs"
00007FF7C3EE86F3 | 48:894424 20                     | mov qword ptr ss:[rsp+20],rax                                                                |
00007FF7C3EE86F8 | 48:8D0D 51F70100                 | lea rcx,qword ptr ds:[7FF7C3F07E50]                                                          | 00007FF7C3F07E50:"called `Result::unwrap()` on an `Err` value"
00007FF7C3EE86FF | 4C:8D0D 7AF70100                 | lea r9,qword ptr ds:[&lt;&amp;sub_7FF7C3EE7D30&gt;]                                                    |
00007FF7C3EE8706 | 4C:8D45 C0                       | lea r8,qword ptr ss:[rbp-40]                                                                 | [rbp-40]:&amp;"tcp.SrcPort == "
00007FF7C3EE870A | BA 2B000000                      | mov edx,2B                                                                                   | 2B:'+'
00007FF7C3EE870F | E8 ECDD0100                      | call &lt;windivert.core::result::unwrap_failed::h70751bb42e9051bd&gt;                              |
00007FF7C3EE8714 | E9 84000000                      | jmp windivert.7FF7C3EE879D                                                                   |
00007FF7C3EE8719 | 48:8945 30                       | mov qword ptr ss:[rbp+30],rax                                                                |
00007FF7C3EE871D | 48:894D 28                       | mov qword ptr ss:[rbp+28],rcx                                                                |
00007FF7C3EE8721 | 48:8B45 D0                       | mov rax,qword ptr ss:[rbp-30]                                                                |
00007FF7C3EE8725 | 48:8945 38                       | mov qword ptr ss:[rbp+38],rax                                                                | [rbp+38]:std::thread::spawnhook::ChildSpawnHooks::run+17C
00007FF7C3EE8729 | 48:8D0D 60FE0100                 | lea rcx,qword ptr ds:[&lt;anon.70de80080aa0578d8e2c0b1b642816f1.8.llvm.9175985875024411532&gt;]    | 00007FF7C3F08590:"internal error: entered unreachable code"
00007FF7C3EE8730 | 4C:8D05 29FF0100                 | lea r8,qword ptr ds:[&lt;anon.70de80080aa0578d8e2c0b1b642816f1.11.llvm.9175985875024411532&gt;]    | 00007FF7C3F08660:&amp;"C:\\Users\\jozef\\.rustup\\toolchains\\stable-x86_64-pc-windows-msvc\\lib/rustlib/src/rust\\library\\std\\src\\sync\\mpmc\\mod.rs"
00007FF7C3EE8737 | BA 28000000                      | mov edx,28                                                                                   | 28:'('
00007FF7C3EE873C | E8 3FDB0100                      | call &lt;windivert.core::panicking::panic::h0cc6c70cb61d6977&gt;                                   |
00007FF7C3EE8741 | EB 5A                            | jmp windivert.7FF7C3EE879D                                                                   |
00007FF7C3EE8743 | 0F1085 80000000                  | movups xmm0,xmmword ptr ss:[rbp+80]                                                          |
00007FF7C3EE874A | 0F108D 90000000                  | movups xmm1,xmmword ptr ss:[rbp+90]                                                          |
00007FF7C3EE8751 | 0F294D D0                        | movaps xmmword ptr ss:[rbp-30],xmm1                                                          |
00007FF7C3EE8755 | 0F2945 C0                        | movaps xmmword ptr ss:[rbp-40],xmm0                                                          |
00007FF7C3EE8759 | 48:8D05 68FA0100                 | lea rax,qword ptr ds:[7FF7C3F081C8]                                                          | rax:&amp;"tcp.SrcPort == ", 00007FF7C3F081C8:&amp;"src\\main.rs"
00007FF7C3EE8760 | 48:894424 20                     | mov qword ptr ss:[rsp+20],rax                                                                |
00007FF7C3EE8765 | 48:8D0D E4F60100                 | lea rcx,qword ptr ds:[7FF7C3F07E50]                                                          | 00007FF7C3F07E50:"called `Result::unwrap()` on an `Err` value"
00007FF7C3EE876C | 4C:8D0D BDF60100                 | lea r9,qword ptr ds:[7FF7C3F07E30]                                                           |
00007FF7C3EE8773 | 4C:8D45 C0                       | lea r8,qword ptr ss:[rbp-40]                                                                 | [rbp-40]:&amp;"tcp.SrcPort == "
00007FF7C3EE8777 | BA 2B000000                      | mov edx,2B                                                                                   | 2B:'+'
00007FF7C3EE877C | E8 7FDD0100                      | call &lt;windivert.core::result::unwrap_failed::h70751bb42e9051bd&gt;                              |
00007FF7C3EE8781 | EB 1A                            | jmp windivert.7FF7C3EE879D                                                                   |
00007FF7C3EE8783 | 45:31E4                          | xor r12d,r12d                                                                                |
00007FF7C3EE8786 | EB 03                            | jmp windivert.7FF7C3EE878B                                                                   |
00007FF7C3EE8788 | 4D:89FE                          | mov r14,r15                                                                                  |
00007FF7C3EE878B | 4C:8D05 96F90100                 | lea r8,qword ptr ds:[7FF7C3F08128]                                                           | 00007FF7C3F08128:&amp;"C:\\Users\\jozef\\.rustup\\toolchains\\stable-x86_64-pc-windows-msvc\\lib/rustlib/src/rust\\library\\alloc\\src\\slice.rs"
00007FF7C3EE8792 | 4C:89E1                          | mov rcx,r12                                                                                  |
00007FF7C3EE8795 | 4C:89F2                          | mov rdx,r14                                                                                  |
00007FF7C3EE8798 | E8 B6D80100                      | call &lt;windivert.alloc::raw_vec::handle_error::h5d55154af761dff4&gt;                             |
00007FF7C3EE879D | 0F0B                             | ud2                                                                                          |
00007FF7C3EE879F | 90                               | nop                                                                                          |
00007FF7C3EE87A0 | 48:895424 10                     | mov qword ptr ss:[rsp+10],rdx                                                                |
00007FF7C3EE87A5 | 55                               | push rbp                                                                                     |
00007FF7C3EE87A6 | 41:57                            | push r15                                                                                     |
00007FF7C3EE87A8 | 41:56                            | push r14                                                                                     |
00007FF7C3EE87AA | 41:55                            | push r13                                                                                     |
00007FF7C3EE87AC | 41:54                            | push r12                                                                                     |
00007FF7C3EE87AE | 56                               | push rsi                                                                                     |
00007FF7C3EE87AF | 57                               | push rdi                                                                                     |
00007FF7C3EE87B0 | 53                               | push rbx                                                                                     |
00007FF7C3EE87B1 | 48:83EC 28                       | sub rsp,28                                                                                   |
00007FF7C3EE87B5 | 48:8DAA 80000000                 | lea rbp,qword ptr ds:[rdx+80]                                                                |
00007FF7C3EE87BC | 48:8B4D 68                       | mov rcx,qword ptr ss:[rbp+68]                                                                |
00007FF7C3EE87C0 | 48:8B01                          | mov rax,qword ptr ds:[rcx]                                                                   | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE87C3 | 48:83C1 08                       | add rcx,8                                                                                    |
00007FF7C3EE87C7 | 48:85C0                          | test rax,rax                                                                                 | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE87CA | 74 0C                            | je windivert.7FF7C3EE87D8                                                                    |
00007FF7C3EE87CC | 83F8 01                          | cmp eax,1                                                                                    |
00007FF7C3EE87CF | 75 6B                            | jne windivert.7FF7C3EE883C                                                                   |
00007FF7C3EE87D1 | E8 AAE7FFFF                      | call &lt;windivert.std::sync::mpmc::counter::Sender$LT$C$GT$::release::h556aa944d0fa04c6&gt;       |
00007FF7C3EE87D6 | EB 69                            | jmp windivert.7FF7C3EE8841                                                                   |
00007FF7C3EE87D8 | 48:8B31                          | mov rsi,qword ptr ds:[rcx]                                                                   |
00007FF7C3EE87DB | F048:FF8E 00020000               | lock dec qword ptr ds:[rsi+200]                                                              |
00007FF7C3EE87E3 | 75 5C                            | jne windivert.7FF7C3EE8841                                                                   |
00007FF7C3EE87E5 | 48:8B86 80000000                 | mov rax,qword ptr ds:[rsi+80]                                                                | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE87EC | 48:8B8E 90010000                 | mov rcx,qword ptr ds:[rsi+190]                                                               |
00007FF7C3EE87F3 | 666666662E:0F1F8400 00000000     | nop word ptr ds:[rax+rax],ax                                                                 |
00007FF7C3EE8800 | 48:89C2                          | mov rdx,rax                                                                                  | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE8803 | 48:09CA                          | or rdx,rcx                                                                                   |
00007FF7C3EE8806 | F048:0FB196 80000000             | lock cmpxchg qword ptr ds:[rsi+80],rdx                                                       |
00007FF7C3EE880F | 75 EF                            | jne windivert.7FF7C3EE8800                                                                   |
00007FF7C3EE8811 | 48:8586 90010000                 | test qword ptr ds:[rsi+190],rax                                                              | rax:&amp;"tcp.SrcPort == "
00007FF7C3EE8818 | 75 0C                            | jne windivert.7FF7C3EE8826                                                                   |
00007FF7C3EE881A | 48:8D8E 40010000                 | lea rcx,qword ptr ds:[rsi+140]                                                               |
00007FF7C3EE8821 | E8 CAB2FFFF                      | call &lt;windivert.std::sync::mpmc::waker::SyncWaker::disconnect::h6ad45fdb3df37a47 (.llvm.9322 |
00007FF7C3EE8826 | B0 01                            | mov al,1                                                                                     |
00007FF7C3EE8828 | 8686 10020000                    | xchg byte ptr ds:[rsi+210],al                                                                |
00007FF7C3EE882E | 84C0                             | test al,al                                                                                   |
00007FF7C3EE8830 | 74 0F                            | je windivert.7FF7C3EE8841                                                                    |
00007FF7C3EE8832 | 48:89F1                          | mov rcx,rsi                                                                                  |
00007FF7C3EE8835 | E8 E6EDFFFF                      | call &lt;windivert.core::ptr::drop_in_place$LT$alloc..boxed..Box$LT$std..sync..mpmc..counter..C |
00007FF7C3EE883A | EB 05                            | jmp windivert.7FF7C3EE8841                                                                   |
00007FF7C3EE883C | E8 8FE8FFFF                      | call &lt;windivert.std::sync::mpmc::counter::Sender$LT$C$GT$::release::h9ff499d21cc3324b&gt;       |
00007FF7C3EE8841 | 90                               | nop                                                                                          |
00007FF7C3EE8842 | 48:83C4 28                       | add rsp,28                                                                                   |
00007FF7C3EE8846 | 5B                               | pop rbx                                                                                      |
00007FF7C3EE8847 | 5F                               | pop rdi                                                                                      |
00007FF7C3EE8848 | 5E                               | pop rsi                                                                                      |
00007FF7C3EE8849 | 41:5C                            | pop r12                                                                                      |
00007FF7C3EE884B | 41:5D                            | pop r13                                                                                      |
00007FF7C3EE884D | 41:5E                            | pop r14                                                                                      |
00007FF7C3EE884F | 41:5F                            | pop r15                                                                                      |
00007FF7C3EE8851 | 5D                               | pop rbp                                                                                      |
00007FF7C3EE8852 | C3                               | ret                                                                                          |
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../exercises/4-fn_trait_object.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../exercises/4-fn_trait_object.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
